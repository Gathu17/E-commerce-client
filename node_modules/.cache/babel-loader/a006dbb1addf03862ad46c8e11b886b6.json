{"ast":null,"code":"import _slicedToArray from\"C:/Users/GATHU/Desktop/E-client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/GATHU/Desktop/E-client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useReducer,createContext}from'react';import jwtDecode from'jwt-decode';import{jsx as _jsx}from\"react/jsx-runtime\";var initialState={user:null};if(localStorage.getItem('jwtToken')){var decodedToken=jwtDecode(localStorage.getItem('jwtToken'));if(decodedToken.exp*1000<Date.now()){localStorage.removeItem('jwtToken');window.location.replace('/');}else{initialState.user=decodedToken;}}var AuthContext=/*#__PURE__*/createContext({user:null,login:function login(userData){},logout:function logout(){}});function authReducer(state,action){switch(action.type){case'LOGIN':return _objectSpread(_objectSpread({},state),{},{user:action.payload});case'LOGOUT':return _objectSpread({},state);default:return{state:state};}}function AuthProvider(props){var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];function login(userData){localStorage.setItem(\"jwtToken\",userData.token);console.log('token set');dispatch({type:'LOGIN',payload:userData});}function logout(){localStorage.removeItem(\"jwtToken\");dispatch({type:'LOGOUT'});}return/*#__PURE__*/_jsx(AuthContext.Provider,_objectSpread({value:{user:state.user,login:login,logout:logout}},props));}export{AuthContext,AuthProvider};","map":{"version":3,"sources":["C:/Users/GATHU/Desktop/E-client/src/util/auth.js"],"names":["React","useReducer","createContext","jwtDecode","initialState","user","localStorage","getItem","decodedToken","exp","Date","now","removeItem","window","location","replace","AuthContext","login","userData","logout","authReducer","state","action","type","payload","AuthProvider","props","dispatch","setItem","token","console","log"],"mappings":"yOAAA,MAAOA,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,aAA5B,KAAgD,OAAhD,CACA,MAAOC,CAAAA,SAAP,KAAsB,YAAtB,C,2CAGA,GAAMC,CAAAA,YAAY,CAAG,CACjBC,IAAI,CAAE,IADW,CAArB,CAIA,GAAGC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAH,CAAoC,CAChC,GAAMC,CAAAA,YAAY,CAAGL,SAAS,CAACG,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAD,CAA9B,CACA,GAAGC,YAAY,CAACC,GAAb,CAAmB,IAAnB,CAA0BC,IAAI,CAACC,GAAL,EAA7B,CAAwC,CACpCL,YAAY,CAACM,UAAb,CAAwB,UAAxB,EACAC,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,GAAxB,EAEH,CAJD,IAIK,CACDX,YAAY,CAACC,IAAb,CAAoBG,YAApB,CAEH,CACJ,CAED,GAAMQ,CAAAA,WAAW,cAAGd,aAAa,CAAC,CAC9BG,IAAI,CAAE,IADwB,CAE9BY,KAAK,CAAE,eAACC,QAAD,CAAc,CAAE,CAFO,CAG9BC,MAAM,CAAE,iBAAM,CAAE,CAHc,CAAD,CAAjC,CAMA,QAASC,CAAAA,WAAT,CAAqBC,KAArB,CAA2BC,MAA3B,CAAkC,CAC9B,OAAOA,MAAM,CAACC,IAAd,EACI,IAAK,OAAL,CACI,sCACOF,KADP,MAEIhB,IAAI,CAAEiB,MAAM,CAACE,OAFjB,GAIJ,IAAK,QAAL,CACI,wBACOH,KADP,EAGJ,QACA,MAAM,CACFA,KAAK,CAALA,KADE,CAAN,CAXJ,CAeH,CAED,QAASI,CAAAA,YAAT,CAAsBC,KAAtB,CAA4B,CACxB,gBAAwBzB,UAAU,CAACmB,WAAD,CAAahB,YAAb,CAAlC,4CAAMiB,KAAN,iBAAYM,QAAZ,iBACA,QAASV,CAAAA,KAAT,CAAeC,QAAf,CAAwB,CACpBZ,YAAY,CAACsB,OAAb,CAAqB,UAArB,CAAgCV,QAAQ,CAACW,KAAzC,EACDC,OAAO,CAACC,GAAR,CAAY,WAAZ,EACCJ,QAAQ,CAAC,CACLJ,IAAI,CAAE,OADD,CAELC,OAAO,CAAEN,QAFJ,CAAD,CAAR,CAIH,CACD,QAASC,CAAAA,MAAT,EAAiB,CACbb,YAAY,CAACM,UAAb,CAAwB,UAAxB,EACAe,QAAQ,CAAC,CACLJ,IAAI,CAAE,QADD,CAAD,CAAR,CAGH,CACD,mBACI,KAAC,WAAD,CAAa,QAAb,gBACA,KAAK,CAAI,CAAClB,IAAI,CAAEgB,KAAK,CAAChB,IAAb,CAAmBY,KAAK,CAALA,KAAnB,CAA0BE,MAAM,CAANA,MAA1B,CADT,EAEIO,KAFJ,EADJ,CAKH,CACD,OAASV,WAAT,CAAsBS,YAAtB","sourcesContent":["import React, { useReducer, createContext} from 'react';\r\nimport jwtDecode from 'jwt-decode'\r\n\r\n\r\nconst initialState = {\r\n    user: null\r\n}\r\n\r\nif(localStorage.getItem('jwtToken')){\r\n    const decodedToken = jwtDecode(localStorage.getItem('jwtToken'))\r\n    if(decodedToken.exp * 1000 < Date.now()){\r\n        localStorage.removeItem('jwtToken')\r\n        window.location.replace('/')\r\n        \r\n    }else{\r\n        initialState.user = decodedToken\r\n        \r\n    }\r\n}\r\n\r\nconst AuthContext = createContext({\r\n    user: null,\r\n    login: (userData) => {},\r\n    logout: () => {}\r\n})\r\n\r\nfunction authReducer(state,action){\r\n    switch(action.type){\r\n        case 'LOGIN':\r\n            return{\r\n                ...state,\r\n                user: action.payload\r\n            }\r\n        case 'LOGOUT':\r\n            return{\r\n                ...state\r\n            }\r\n        default: \r\n        return{\r\n            state\r\n        }\r\n    }\r\n}\r\n\r\nfunction AuthProvider(props){\r\n    const[state,dispatch] = useReducer(authReducer,initialState)\r\n    function login(userData){\r\n        localStorage.setItem(\"jwtToken\",userData.token)\r\n       console.log('token set')\r\n        dispatch({\r\n            type: 'LOGIN',\r\n            payload: userData\r\n        })\r\n    }\r\n    function logout(){\r\n        localStorage.removeItem(\"jwtToken\")\r\n        dispatch({\r\n            type: 'LOGOUT'\r\n        })\r\n    }\r\n    return(\r\n        <AuthContext.Provider\r\n        value = {{user: state.user, login, logout}}\r\n        {...props}/>\r\n    )\r\n}\r\nexport  {AuthContext, AuthProvider} "]},"metadata":{},"sourceType":"module"}